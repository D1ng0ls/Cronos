<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronograma e água</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="source/style/style.css">
</head>
<body id="body">
    <header id="header"></header>
    <div class="fixed hidden">
<textarea id="fixed" disabled></textarea>
    <i class="bi bi-pin-fill" onclick="unpin()"></i>
    </div>
    <main id="home">
        <div class="saudacoes-container container">
            <h3 id="saudacao"></h3>
            <i id="diaAtual"></i>
        </div>
        <div class="home-container container">
            <h1># Resumo</h1>
            <p class="atividade">Atividade atual: <i id="atividadeAtual"></i></p>
            <p class="atividade">Próxima atividade: <i id="atividadeProx"></i></p>
            <p class="atividade">Copos de água: <i id="coposCount"></i><a onclick="somaCopo(true)"> <i class="bi bi-plus-lg"></i></a><a onclick="somaCopo(false)"> <i class="bi bi-dash-lg"></i></a></p>
            <p class="atividade">Meta: <i id="meta"></i></p>
            <p class="atividade">Anotações: <i id="anotacaoCount"></i></p>
            <div class="list-atividade">
                <p class="atividade">Tarefas:</p>
                <ul>
                    <li>Concluídas: <i id="tasksFeitas"></i></li>
                    <li>Para Fazer: <i id="tasksNaoFeitas"></i></li>
                </ul>
            </div>
            
        </div>
        <div class="crono-water">
            <div id="cronograma" class="cronograma-container container">
                <h2><i class="bi bi-calendar3"></i> Cronograma</h2>
                <div class="table-cronos">
                    <table>
                        <thead>
                            <tr>
                                <th>Horário</th>
                                <th>Atividade</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="at1">
                                <td>9h - 10h</td>
                                <td id="desc1">Estudo de programação (Java com Spring Boot ou outra linguagem)</td>
                            </tr>
                            <tr id="at2">
                                <td>10h - 10h15</td>
                                <td id="desc2">Pausa para alongar e relaxar</td>
                            </tr>
                            <tr id="at3">
                                <td>10h15 - 11h</td>
                                <td id="desc3">Continuação dos estudos de programação</td>
                            </tr>
                            <tr id="at4">
                                <td>11h - 11h15</td>
                                <td id="desc4">Pausa</td>
                            </tr>
                            <tr id="at5">
                                <td>11h15 - 12h</td>
                                <td id="desc5">Leitura de livros (meta de 20-30 páginas diárias)</td>
                            </tr>
                            <tr id="at6">
                                <td>12h - 13h</td>
                                <td id="desc6">Almoço e leitura ou estudo leve (vídeos, podcasts)</td>
                            </tr>
                            <tr id="at7">
                                <td>13h - 14h30</td>
                                <td id="desc7">Estudos da faculdade (atividades solo)</td>
                            </tr>
                            <tr id="at8">
                                <td>14h30 - 14h45</td>
                                <td id="desc8">Intervalo</td>
                            </tr>
                            <tr id="at9">
                                <td>14h45 - 16h</td>
                                <td id="desc9">Cursos extras (preenchendo lacunas ou explorando novos temas)</td>
                            </tr>
                            <tr id="at10">
                                <td>16h - 16h15</td>
                                <td id="desc10">Pausa</td>
                            </tr>
                            <tr id="at11">
                                <td>16h15 - 18h</td>
                                <td id="desc11">Continuação dos projetos da faculdade ou leitura de livros</td>
                            </tr>
                            <tr id="at12">
                                <td>18h - 19h</td>
                                <td id="desc12">Jantar e relaxamento</td>
                            </tr>
                            <tr id="at13">
                                <td>19h - 21h</td>
                                <td id="desc13">Estudos da faculdade (junto com a turma) e/ou curso O Novo Mercado</td>
                            </tr>
                            <tr id="at14">
                                <td>Após 21h</td>
                                <td id="desc14">Descanso, hobbies, ou relaxamento</td>
                            </tr>
                        </tbody>
                    </table>
                    <audio id="tableSound" src="source/media/change-table.mp3"></audio>
                </div>
            </div>
            <div id="agua" class="agua-container container">
                <h2><i class="bi bi-cup-straw"></i> Consumo de Água</h2>

                <div id="timer">Próximo lembrete: <span id="time">00:00:00</span></div>

                <div class="btns">
                    <button id="startButton">INICIAR <i class="bi bi-play-fill"></i></button>

                        <input type="number" min="0" value="0" max="99" id="copos" onchange="contaCopos()">
                        <button id="sumButton" onclick="somaCopo(true)">
                            <i class="bi bi-plus-lg"></i>
                        </button>
                        <button id="minusButton" onclick="somaCopo(false)">
                            <i class="bi bi-dash-lg"></i>
                        </button>

                </div>

                <p id="coposBebidos"></p>
                <p class="aviso">Não se esqueça de beber água ao longo do dia!</p>
                <audio id="alarmSound" src="source/media/clock-alarm.mp3"></audio>
            </div>
        </div>
        <div id="notes" class="notes-container container">
            <h2><i class="bi bi-journals"></i> Anotações <i class="bi bi-plus-lg" onclick="addNote()" id="add-note"></i> <i class="bi bi-download" onclick="download()" id="download-note"></i></h2>
            <div id="notations" class="notations">
                <!-- <div class="note note${countNotes}"><i class="bi bi-pin" id="pin"></i><i class="bi bi-trash3" id="excluir"></i><textarea name="note${countNotes}" id="note${countNotes}"></textarea></div> -->
            </div>
        </div>
        <div id="tarefas" class="tarefas-container container">
            <h2><i class="bi bi-list-check"></i> Tarefas <i class="bi bi-plus-lg" onclick="addTask()" id="add-note"></i></h2>
            <div class="tasks-todo" id="tasks">
                <!-- <div class="task task1" id="task1">
                    <input type="text" name="task1" id="todo1" maxlength="50">
                    <input type="checkbox" name="check1" id="check1">
                    <i class="bi bi-trash3" id="excluir"></i>
                    <i class="hidden" id="dataTask1"></i>
                </div> -->
            </div>
        </div>
    </main>
    <div class="unlock" id="unlock">
        <div class="input-unlock">
            <label for="senha">Senha:</label>
            <input type="password" id="senha" name="senha">
        </div>
        <button id="btn-unlock">Desbloquear <i class="bi bi-unlock"></i></button>
    </div>
    <footer id="footer"></footer>

    <noscript>Ative o JavaScript na página para ativar as funcionalidades</noscript>
    <script src="source/script/include.js"></script>
    <script src="source/script/table.js"></script>
    <script src="source/script/water.js"></script>
    <script src="source/script/cups.js"></script>
    <script src="source/script/configs.js"></script>
    <script src="source/script/notes.js"></script>
    <script src="source/script/tasks.js"></script>
    <script src="source/script/login.js"></script>
    <script>
        var data = new Date;
        var hour = data.getHours();
        var diaAtual = document.getElementById("diaAtual");
        const diaSemana = ["Domingo", "Segunda-Feira", "Terça-Feira", "Quarta-Feira", "Quinta-Feira", "Sexta-Feira", "Sábado"]
        const mesNome = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"]
        
        var saudacao = document.getElementById('saudacao');

        var dots = 0;

        msgDia();
        
        function msgDia() {
            data = new Date;
            hour = data.getHours()
            diaAtual.innerHTML = diaSemana[data.getDay()] + ", " + data.getDate() + " de " + mesNome[data.getMonth()] + " de " + data.getFullYear() + " - " + data.getHours() + "h " + data.getMinutes() + "min";
            dots++;

            if (dots <= 3) {
                for(var i=0; i<dots; i++) {
                    diaAtual.innerHTML += "."
                }
            } else {
                diaAtual.innerHTML = diaSemana[data.getDay()] + ", " + data.getDate() + " de " + mesNome[data.getMonth()] + " de " + data.getFullYear() + " - " + data.getHours() + "h " + data.getMinutes() + "min";   
                dots = 0;
            }
            
        }

        setInterval(msgDia, 400)

        if(hour < 12) {
            saudacao.innerHTML += "<i class='bi bi-sunrise'></i> Bom dia, ";
        } else {
            if(hour < 18) {
                saudacao.innerHTML += "<i class='bi bi-sun'></i> Boa tarde, ";
            } else {
                saudacao.innerHTML += "<i class='bi bi-moon'></i> Boa noite, ";
            }
        }
        saudacao.innerHTML += getSettingValue('nome');

        document.getElementById("meta").textContent = getSettingValue('cups') + " Copos";
        contaCopos();

        timer(getSettingValue("mins"));

        atualizaContadorTask();
    </script>
    <script>
        // resetNote()
        // resetTask()

        if(localStorage.getItem('pinnedId') == null) {
            localStorage.setItem('pinnedId', 0)
        }

        if(localStorage.getItem('pinnedId') != 0) {    
            getPin(localStorage.getItem('pinnedId'))
            console.log("pinned global is " + localStorage.getItem('pinnedId'))
        }
        
        function pinned(note) {
            if (localStorage.getItem('pinnedId') != note) {
                document.getElementById('fixed').textContent = document.getElementById('note'+ note).textContent
                document.querySelector('.fixed').classList.remove("hidden")
                
                localStorage.setItem('pinnedId', note)
            } else {
                document.querySelector('.fixed').classList.add("hidden")
                localStorage.setItem('pinnedId', 0)         
            }

            console.log("pinned global is " + localStorage.getItem('pinnedId'))
        }

        function getPin(note) {
            document.getElementById('fixed').textContent = document.getElementById('note'+ note).textContent
            document.querySelector('.fixed').classList.remove("hidden")
        }

        function unpin() {
            pinned(localStorage.getItem('pinnedId'))
        }
    </script>
    <script>
        function download() {
            let content = "";

            for (var i = 1; i <= localStorage.getItem('countNotesStorage'); i++) {
                try {
                    content += `Anotação ${i}: \n${document.getElementById('note'+i).textContent}\n\n`;
                } catch (ex) {
                    content += '';
                }
            }

            
            const blob = new Blob([content], { type: "text/plain" });
            const url = URL.createObjectURL(blob);

            const a = document.createElement("a");
            a.href = url;
            a.download = "anotacoes.txt";
            document.body.appendChild(a);
            a.click();

            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>